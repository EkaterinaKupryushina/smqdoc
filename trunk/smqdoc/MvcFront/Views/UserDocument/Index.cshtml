@using Telerik.Web.Mvc.UI
@using MvcFront.Models
@model IEnumerable<DocumentListViewModel>
@{
    ViewBag.Title = "Index";
}
<script type="text/javascript">
    function onDocumentListGridRowDataBound(e) {
        if (e.dataItem.IsReadOnly > 0) {
            $(e.row).find('a.t-grid-EditDetails').remove(); 
            $(e.row).find('a.t-grid-DeleteDetails').remove();
        }
        if(e.dataItem.IsRed > 0) {
            $(e.row).css("color","red");
        }
    }
</script>
<script type="text/javascript">
    function onGroupTemplateListGridRowDataBound(e) {
        if (e.dataItem.IsRed > 0) {
            $(e.row).css("color", "red");
        }
    }
</script>
<h2>Необходимо начать заполнять документы:</h2>
@* ReSharper disable ConvertToLambdaExpression *@
@(Html.Telerik().Grid<GroupTemplateListViewModel>()
     .DataBinding(dataBinding => dataBinding.Ajax().Select("_UserGroupTeplatesList", "UserDocument", new {  }))
        .Name("GroupTemplateListGrid")
                .ClientEvents(events => events.OnRowDataBound("onGroupTemplateListGridRowDataBound"))
                   .Columns(columns =>
                   {
                       columns.AutoGenerate(column =>
                       {
                           if (column.Member == "ID" || column.Member == "DocTemplateName" || column.Member == "UserGroupName" || column.Member == "Status" ||column.Member == "IsRed")
                               column.Visible = false;
                       });
                       columns.Command(command =>
                       {
                           command.Custom("CreateDetails").Text("Начать заполнение")
                            .DataRouteValues(route => route.Add(o => o.ID).RouteKey("id"))
                            .Action("Create", "UserDocument")
                            .HtmlAttributes(new { style = "text-align: center" });
                       }).Width(40);
                   })
                 .Sortable()
                .Pageable()

    ) 
@* ReSharper restore ConvertToLambdaExpression *@
<h2>Список документов</h2>

@(Html.Telerik().Grid<DocumentListViewModel>()
    .DataBinding(dataBinding => dataBinding.Ajax().Select("_UserDocumentsList", "UserDocument", new { }))
        .ClientEvents(events => events.OnRowDataBound("onDocumentListGridRowDataBound"))
        .Name("DocumentListGrid")
                   .Columns(columns =>
                   {
                       columns.AutoGenerate(column =>
                       {
                           column.Width = "150px";
                           if (column.Member == "DocumentId" || column.Member == "IsReadOnly" || column.Member == "IsRed")
                               column.Visible = false;
                       });
                       columns.Command(command =>
                       {
                           command.Custom("viewDetails").Text("Просмотр")
                            .DataRouteValues(route => route.Add(o => o.DocumentId).RouteKey("id"))
                            .Action("Details", "UserDocument")
                            .HtmlAttributes(new { style = "text-align: center" });
                           command.Custom("EditDetails").Text("Редактировать")
                            .DataRouteValues(route => route.Add(o => o.DocumentId).RouteKey("id"))
                            .Action("Edit", "UserDocument")
                            .HtmlAttributes(new { style = "text-align: center" });
                       }).Width(50);
                   })
                  
                 .Sortable()
                .Pageable()

    ) 
